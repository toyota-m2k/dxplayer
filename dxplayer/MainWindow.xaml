<Window x:Class="dxplayer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:dxplayer"
        xmlns:common="clr-namespace:io.github.toyota32k.toolkit.view;assembly=io.github.toyota32k.wpfLittleToolkit"
        mc:Ignorable="d"
        Loaded="OnLoaded"
        Title="DxPlayer" Height="450" Width="800">
    <Window.Resources>
        <ResourceDictionary Source="res/CustomResource.xaml"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>     <!-- ToolBar -->
            <RowDefinition Height="*"/>        <!-- ListView -->
            <RowDefinition Height="Auto"/>     <!-- StatusBar -->
        </Grid.RowDefinitions>
        
        <!-- ToolBar -->
        <Grid Grid.Row="0" Background="{StaticResource ToolBarBG}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.Resources>
                <Path x:Key="PathOpenFile" Data="M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathAddFolder" Data="M10,4L12,6H20A2,2 0 0,1 22,8V18A2,2 0 0,1 20,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10M15,9V12H12V14H15V17H17V14H20V12H17V9H15Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathPlay" Data="M8,5.14V19.14L19,12.14L8,5.14Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathPlayPreview" Data="M10,16.5V7.5L16,12M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathCounter" Data="M4,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M4,6V18H11V6H4M20,18V6H18.76C19,6.54 18.95,7.07 18.95,7.13C18.88,7.8 18.41,8.5 18.24,8.75L15.91,11.3L19.23,11.28L19.24,12.5L14.04,12.47L14,11.47C14,11.47 17.05,8.24 17.2,7.95C17.34,7.67 17.91,6 16.5,6C15.27,6.05 15.41,7.3 15.41,7.3L13.87,7.31C13.87,7.31 13.88,6.65 14.25,6H13V18H15.58L15.57,17.14L16.54,17.13C16.54,17.13 17.45,16.97 17.46,16.08C17.5,15.08 16.65,15.08 16.5,15.08C16.37,15.08 15.43,15.13 15.43,15.95H13.91C13.91,15.95 13.95,13.89 16.5,13.89C19.1,13.89 18.96,15.91 18.96,15.91C18.96,15.91 19,17.16 17.85,17.63L18.37,18H20M8.92,16H7.42V10.2L5.62,10.76V9.53L8.76,8.41H8.92V16Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathExcellent" Data="M18.9,18.94L15.94,16C15.76,15.79 15.55,15.5 15.55,15.05A1.3,1.3 0 0,1 16.85,13.75C17.19,13.75 17.53,13.89 17.77,14.15L18.91,15.26L20.03,14.13C20.27,13.89 20.61,13.75 20.95,13.75A1.3,1.3 0 0,1 22.25,15.05C22.25,15.39 22.11,15.73 21.87,15.97L18.9,18.94M17.46,19.62C15.72,21.1 13.47,22 11,22A10,10 0 0,1 1,12A10,10 0 0,1 11,2A10,10 0 0,1 21,12C21,12.09 21,12.17 20.95,12.25C20.21,12.25 19.5,12.55 18.97,13.07L18.9,13.14L18.84,13.09C18.32,12.55 17.6,12.25 16.85,12.25A2.8,2.8 0 0,0 14.05,15.05C14.05,15.78 14.34,16.5 14.87,17.03L17.46,19.62M13,9.5C13,10.3 13.7,11 14.5,11C15.3,11 16,10.3 16,9.5C16,8.7 15.3,8 14.5,8C13.7,8 13,8.7 13,9.5M9,9.5C9,8.7 8.3,8 7.5,8C6.7,8 6,8.7 6,9.5C6,10.3 6.7,11 7.5,11C8.3,11 9,10.3 9,9.5M12.94,15.18L14,14.12L11.88,12L10.82,13.06L11.88,14.12L10.82,15.18L11.88,16.24L10.82,17.3L11.88,18.36L14,16.24L12.94,15.18Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathGood" Data="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M8.88,7.82L11,9.94L9.94,11L8.88,9.94L7.82,11L6.76,9.94L8.88,7.82M12,17.5C9.67,17.5 7.69,16.04 6.89,14H17.11C16.31,16.04 14.33,17.5 12,17.5M16.18,11L15.12,9.94L14.06,11L13,9.94L15.12,7.82L17.24,9.94L16.18,11Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathNormal" Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5M12,17.23C10.25,17.23 8.71,16.5 7.81,15.42L9.23,14C9.68,14.72 10.75,15.23 12,15.23C13.25,15.23 14.32,14.72 14.77,14L16.19,15.42C15.29,16.5 13.75,17.23 12,17.23M15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8C16.3,8 17,8.7 17,9.5C17,10.3 16.3,11 15.5,11Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathBad" Data="M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M15.5,8C16.3,8 17,8.7 17,9.5C17,10.3 16.3,11 15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8M10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5M12,14C13.75,14 15.29,14.72 16.19,15.81L14.77,17.23C14.32,16.5 13.25,16 12,16C10.75,16 9.68,16.5 9.23,17.23L7.81,15.81C8.71,14.72 10.25,14 12,14Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathDreadful" Data="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M16.18,7.76L15.12,8.82L14.06,7.76L13,8.82L14.06,9.88L13,10.94L14.06,12L15.12,10.94L16.18,12L17.24,10.94L16.18,9.88L17.24,8.82L16.18,7.76M7.82,12L8.88,10.94L9.94,12L11,10.94L9.94,9.88L11,8.82L9.94,7.76L8.88,8.82L7.82,7.76L6.76,8.82L7.82,9.88L6.76,10.94L7.82,12M12,14C9.67,14 7.69,15.46 6.89,17.5H17.11C16.31,15.46 14.33,14 12,14Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathSort" Data="M3 13H15V11H3M3 6V8H21V6M3 18H9V16H3V18M22.54 16.88L20.41 19L22.54 21.12L21.12 22.54L19 20.41L16.88 22.54L15.47 21.12L17.59 19L15.47 16.88L16.88 15.47L19 17.59L21.12 15.46L22.54 16.88" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathFilter" Data="M15,19.88C15.04,20.18 14.94,20.5 14.71,20.71C14.32,21.1 13.69,21.1 13.3,20.71L9.29,16.7C9.06,16.47 8.96,16.16 9,15.87V10.75L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L15,10.75V19.88M7.04,5L11,10.06V15.58L13,17.58V10.05L16.96,5H7.04Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                <Path x:Key="PathSettings" Data="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
            </Grid.Resources>

            <!-- Left ToolBar -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left">
                <!-- Open DB ... use MRU's programatically -->
                <common:MenuButton 
                    x:Name="mOpenDBButton"
                    Content="{StaticResource PathOpenFile}"
                    Style="{StaticResource IconToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Open DB File"/>
                    </ToolTipService.ToolTip>
                </common:MenuButton>

                <!-- DB Management : Add Items / Refresh -->
                <common:MenuButton 
                    Content="{StaticResource PathAddFolder}" 
                    Style="{StaticResource IconToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Register Folder to DB"/>
                    </ToolTipService.ToolTip>
                    <common:MenuButton.DropDownMenu>
                        <ContextMenu>
                            <MenuItem Header="Add Folders" Command="{Binding AddFolderCommand}"/>
                            <MenuItem Header="Import from wfPlayer" Command="{Binding ImportFromWfCommand}"/>
                            <MenuItem Header="Refresh All" Command="{Binding RefreshAllCommand}"/>
                            <MenuItem Header="Select Duplicate Files" Command="{Binding SelectDupCommand}"/>
                        </ContextMenu>
                    </common:MenuButton.DropDownMenu>
                </common:MenuButton>

                <!-- Play Command -->
                <common:CheckButton 
                    Command="{Binding PlayCommand}" 
                    Content="{StaticResource PathPlay}" 
                    Style="{StaticResource CheckButtonStyle}" 
                    Margin="12,0,0,0"
                    IsChecked="{Binding Playing.Value}"
                    >
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Play"/>
                    </ToolTipService.ToolTip>
                </common:CheckButton>

                <!-- Preview -->
                <common:CheckButton
                    Command="{Binding PreviewCommand}" 
                    Content="{StaticResource PathPlayPreview}" 
                    Style="{StaticResource CheckButtonStyle}"
                    IsChecked="{Binding Checking.Value}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Play to check (not to increment counter)"/>
                    </ToolTipService.ToolTip>
                </common:CheckButton>

                <!-- Reset Counter -->
                <Button Command="{Binding DecrementCounterCommand}"  Content="{StaticResource PathCounter}" Style="{StaticResource PushButtonStyle}" Margin="12,0,0,0">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Decrement Counter"/>
                    </ToolTipService.ToolTip>
                </Button>

                <!-- Rating -->

                <ToggleButton Content="{StaticResource PathSort}" Style="{StaticResource IconToggleButtonStyle}" IsChecked="{Binding SortInfo.Shuffle, Mode=TwoWay}" Margin="12,0,0,0">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Sort"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>

            </StackPanel>
            <!-- Right ToolBar -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <StackPanel
                    Visibility="{Binding ListFilter.Enabled, Converter={StaticResource BoolVisibilityConverter}}"
                    Orientation="Horizontal"
                    >
                    <StackPanel.Resources>
                        <Style x:Key="CheckedFilterIconStyle" TargetType="Path">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=ListFilter.Checked}" Value="TRUE">
                                    <Setter Property="Data" Value="M19,19H5V5H15V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V11H19M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"/>
                                    <Setter Property="Fill" Value="#C0FFC0"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=ListFilter.Checked}" Value="FALSE">
                                    <Setter Property="Data" Value="M3,21V3H21V21H3M5,5V19H19V5H5Z"/>
                                    <Setter Property="Fill" Value="White"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=ListFilter.Checked}" Value="NONE">
                                    <Setter Property="Data" Value="M20 14H4V10H20V14Z"/>
                                    <Setter Property="Fill" Value="White"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                        <Style x:Key="CounterFilterIconStyle" TargetType="Path">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=ListFilter.PlayCountCP}" Value="NONE">
                                    <Setter Property="Data" Value="M20 14H4V10H20V14Z"/>
                                    <Setter Property="Fill" Value="White"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=ListFilter.PlayCountCP}" Value="GE">
                                    <Setter Property="Data" Value="M6.5,2.27L20,10.14L6.5,18L5.5,16.27L16.03,10.14L5.5,4L6.5,2.27M20,20V22H5V20H20Z"/>
                                    <Setter Property="Fill" Value="White"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=ListFilter.PlayCountCP}" Value="EQ">
                                    <Setter Property="Data" Value="M19,10H5V8H19V10M19,16H5V14H19V16Z"/>
                                    <Setter Property="Fill" Value="White"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=ListFilter.PlayCountCP}" Value="LE">
                                    <Setter Property="Data" Value="M18.5,2.27L5,10.14L18.5,18L19.5,16.27L8.97,10.14L19.5,4L18.5,2.27M5,20V22H20V20H5Z"/>
                                    <Setter Property="Fill" Value="White"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Resources>
                    <TextBlock Text="Play Count" Margin="0" VerticalAlignment="Center" Foreground="LightGray"/>
                    <common:MenuButton
                        Style="{StaticResource IconToggleButtonStyle}">
                        <Viewbox>
                            <Canvas Width="24" Height="24">
                                <Path Style="{StaticResource CounterFilterIconStyle}"/>
                            </Canvas>
                        </Viewbox>
                        <ToolTipService.ToolTip>
                            <ToolTip Content="Filter by play-count"/>
                        </ToolTipService.ToolTip>
                        <common:MenuButton.DropDownMenu>
                            <ContextMenu>
                                <MenuItem Header="None" Command="{Binding CountFilterCommand}" CommandParameter="NONE"/>
                                <MenuItem Header="==" Command="{Binding CountFilterCommand}" CommandParameter="EQ"/>
                                <MenuItem Header=">=" Command="{Binding CountFilterCommand}" CommandParameter="GE"/>
                                <MenuItem Header="&lt;=" Command="{Binding CountFilterCommand}" CommandParameter="LE"/>
                            </ContextMenu>
                        </common:MenuButton.DropDownMenu>
                    </common:MenuButton>
                    <common:NumericTextBox
                        Text="{Binding ListFilter.PlayCount}"
                        MinWidth="30"
                        VerticalAlignment="Center"
                        IsEnabled="{Binding ListFilter.PlayCountCP, ConverterParameter=NONE, Converter={StaticResource NegEnumBooleanConverter}}"
                        />

                    <TextBlock Text="Checked" Margin="16,0 0,0" VerticalAlignment="Center" Foreground="LightGray"/>
                    <common:MenuButton
                        Style="{StaticResource IconToggleButtonStyle}">
                        <Viewbox>
                            <Canvas Width="24" Height="24">
                                <Path Style="{StaticResource CheckedFilterIconStyle}"/>
                            </Canvas>
                        </Viewbox>
                        <ToolTipService.ToolTip>
                            <ToolTip Content="Filter checked or unchecked items"/>
                        </ToolTipService.ToolTip>
                        <common:MenuButton.DropDownMenu>
                            <ContextMenu>
                                <MenuItem Header="None" Command="{Binding CheckedFilterCommand}" CommandParameter="NONE"/>
                                <MenuItem Header="Checked" Command="{Binding CheckedFilterCommand}" CommandParameter="TRUE"/>
                                <MenuItem Header="Unchecked" Command="{Binding CheckedFilterCommand}" CommandParameter="FALSE"/>
                            </ContextMenu>
                        </common:MenuButton.DropDownMenu>
                    </common:MenuButton>

                    <TextBlock Text="Rating" Margin="8,0 0,0" VerticalAlignment="Center" Foreground="LightGray"/>
                    <ToggleButton 
                        IsChecked="{Binding ListFilter.Dreadful, Mode=TwoWay}" 
                        Content="{StaticResource PathDreadful}" 
                        Style="{StaticResource RatingDreadfulButtonStyle}">
                            <ToolTipService.ToolTip>
                                <ToolTip Content="Filter: Dreadful"/>
                            </ToolTipService.ToolTip>
                    </ToggleButton>
                    <ToggleButton 
                        IsChecked="{Binding ListFilter.Bad, Mode=TwoWay}" 
                        Content="{StaticResource PathBad}" 
                        Style="{StaticResource RatingBadButtonStyle}">
                            <ToolTipService.ToolTip>
                                <ToolTip Content="Filter: Bad"/>
                            </ToolTipService.ToolTip>
                    </ToggleButton>
                    <ToggleButton 
                        IsChecked="{Binding ListFilter.Normal, Mode=TwoWay}" 
                        Content="{StaticResource PathNormal}" 
                        Style="{StaticResource RatingNormalButtonStyle}">
                            <ToolTipService.ToolTip>
                                <ToolTip Content="Filter: Normal"/>
                            </ToolTipService.ToolTip>
                    </ToggleButton>
                    <ToggleButton 
                        IsChecked="{Binding ListFilter.Good, Mode=TwoWay}" 
                        Content="{StaticResource PathGood}" 
                        Style="{StaticResource RatingGoodButtonStyle}">
                            <ToolTipService.ToolTip>
                                <ToolTip Content="Filter: Good"/>
                            </ToolTipService.ToolTip>
                    </ToggleButton>
                    <ToggleButton 
                        IsChecked="{Binding ListFilter.Excellent, Mode=TwoWay}" 
                        Content="{StaticResource PathExcellent}" 
                        Style="{StaticResource RatingExcellentButtonStyle}">
                            <ToolTipService.ToolTip>
                                <ToolTip Content="Filter: Excellent"/>
                            </ToolTipService.ToolTip>
                    </ToggleButton>
                </StackPanel>

                <ToggleButton IsChecked="{Binding ListFilter.Enabled, Mode=TwoWay}" Content="{StaticResource PathFilter}" Style="{StaticResource IconToggleButtonStyle}" Margin="8,0,0,0">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Filter"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>


                <Button Command="{Binding SettingCommand}" Content="{StaticResource PathSettings}" Style="{StaticResource PushButtonStyle}" Margin="8,0">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Settings"/>
                    </ToolTipService.ToolTip>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Main List -->
        <common:StretchListView 
            Grid.Row="1"
            x:Name="MainListView" 
            ItemsSource="{Binding MainList.Value}" 
            GridViewColumnHeader.Click="OnHeaderClick" 
            StretchColumnIndex="12" 
            StretchColumnMinWidth="100">
            <ListView.Resources>
                <Style x:Key="CheckIconStyle" TargetType="Path">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=Checked}" Value="True">
                            <Setter Property="Data" Value="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/>
                            <Setter Property="Fill" Value="#00C000"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Checked}" Value="False">
                            <Setter Property="Data" Value=""/>
                            <Setter Property="Fill" Value="White"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
                <Style x:Key="RatingIconStyle" TargetType="Path">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="EXCELLENT">
                            <Setter Property="Data" Value="M18.9,18.94L15.94,16C15.76,15.79 15.55,15.5 15.55,15.05A1.3,1.3 0 0,1 16.85,13.75C17.19,13.75 17.53,13.89 17.77,14.15L18.91,15.26L20.03,14.13C20.27,13.89 20.61,13.75 20.95,13.75A1.3,1.3 0 0,1 22.25,15.05C22.25,15.39 22.11,15.73 21.87,15.97L18.9,18.94M17.46,19.62C15.72,21.1 13.47,22 11,22A10,10 0 0,1 1,12A10,10 0 0,1 11,2A10,10 0 0,1 21,12C21,12.09 21,12.17 20.95,12.25C20.21,12.25 19.5,12.55 18.97,13.07L18.9,13.14L18.84,13.09C18.32,12.55 17.6,12.25 16.85,12.25A2.8,2.8 0 0,0 14.05,15.05C14.05,15.78 14.34,16.5 14.87,17.03L17.46,19.62M13,9.5C13,10.3 13.7,11 14.5,11C15.3,11 16,10.3 16,9.5C16,8.7 15.3,8 14.5,8C13.7,8 13,8.7 13,9.5M9,9.5C9,8.7 8.3,8 7.5,8C6.7,8 6,8.7 6,9.5C6,10.3 6.7,11 7.5,11C8.3,11 9,10.3 9,9.5M12.94,15.18L14,14.12L11.88,12L10.82,13.06L11.88,14.12L10.82,15.18L11.88,16.24L10.82,17.3L11.88,18.36L14,16.24L12.94,15.18Z"/>
                            <Setter Property="Fill" Value="Red"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="GOOD">
                            <Setter Property="Data" Value="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M13,9.94L14.06,11L15.12,9.94L16.18,11L17.24,9.94L15.12,7.82L13,9.94M8.88,9.94L9.94,11L11,9.94L8.88,7.82L6.76,9.94L7.82,11L8.88,9.94M12,17.5C14.33,17.5 16.31,16.04 17.11,14H6.89C7.69,16.04 9.67,17.5 12,17.5Z"/>
                            <Setter Property="Fill" Value="Orange"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="NORMAL">
                            <Setter Property="Data" Value="M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5M17,9.5C17,10.3 16.3,11 15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8C16.3,8 17,8.7 17,9.5M12,17.23C10.25,17.23 8.71,16.5 7.81,15.42L9.23,14C9.68,14.72 10.75,15.23 12,15.23C13.25,15.23 14.32,14.72 14.77,14L16.19,15.42C15.29,16.5 13.75,17.23 12,17.23Z"/>
                            <Setter Property="Fill" Value="SlateGray"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="BAD">
                            <Setter Property="Data" Value="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5M14.77,17.23C14.32,16.5 13.25,16 12,16C10.75,16 9.68,16.5 9.23,17.23L7.81,15.81C8.71,14.72 10.25,14 12,14C13.75,14 15.29,14.72 16.19,15.81L14.77,17.23M15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8C16.3,8 17,8.7 17,9.5C17,10.3 16.3,11 15.5,11Z"/>
                            <Setter Property="Fill" Value="DeepSkyBlue"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="DREADFUL">
                            <Setter Property="Data" Value="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M6.76,8.82L7.82,7.76L8.88,8.82L9.94,7.76L11,8.82L9.94,9.88L11,10.94L9.94,12L8.88,10.94L7.82,12L6.76,10.94L7.82,9.88L6.76,8.82M6.89,17.5C7.69,15.46 9.67,14 12,14C14.33,14 16.31,15.46 17.11,17.5H6.89M17.24,10.94L16.18,12L15.12,10.94L14.06,12L13,10.94L14.06,9.88L13,8.82L14.06,7.76L15.12,8.82L16.18,7.76L17.24,8.82L16.18,9.88L17.24,10.94Z"/>
                            <Setter Property="Fill" Value="MediumBlue"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>


                <DataTemplate x:Key="SortHeaderTemplate">
                    <DockPanel>
                        <Image Width="10" Height="10" DockPanel.Dock="Right" Margin="5,0,0,0">
                            <Image.Style>
                                <Style>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=GridViewColumnHeader}}" Value="asc">
                                            <Setter Property="Image.Source" Value="{StaticResource AscImageSource}"/>
                                            <Setter Property="Image.Visibility" Value="Visible"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=GridViewColumnHeader}}" Value="desc">
                                            <Setter Property="Image.Source" Value="{StaticResource DescImageSource}"/>
                                            <Setter Property="Image.Visibility" Value="Visible"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=GridViewColumnHeader}}" Value="">
                                            <Setter Property="Image.Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Image.Style>
                        </Image>
                        <TextBlock Foreground="DarkBlue">
                            <TextBlock.Text>
                                <Binding/>
                            </TextBlock.Text>
                        </TextBlock>
                    </DockPanel>
                </DataTemplate>
            </ListView.Resources>
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <EventSetter Event="MouseDoubleClick" Handler="OnListItemDoubleClick"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="ContextMenu">
                        <Setter.Value>
                            <ContextMenu Background="WhiteSmoke">
                                <MenuItem Header="Reset Play Counter (_N)" InputGestureText="Ctrl+N" Command="{Binding ResetCounterCommand}"/>
                                <MenuItem Header="Delete Files (_D)" InputGestureText="Ctrl+D" Command="{Binding DeleteItemCommand}"/>
                            </ContextMenu>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListView.ItemContainerStyle>

            <ListView.View>
                <GridView>
                    <GridViewColumn Header="ID" Width="100" DisplayMemberBinding="{Binding KeyFromName}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                    <GridViewColumn Header="Name" Width="100" DisplayMemberBinding="{Binding Name}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                    <GridViewColumn Header="Type" Width="50" DisplayMemberBinding="{Binding Type}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                    <GridViewColumn Header="Size" Width="80" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Size, Converter={StaticResource DecimalStringConverter}}" TextAlignment="Right"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Duration" Width="50" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Duration, Converter={StaticResource DurationStringConverter}}" TextAlignment="Right"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Date" Width="120" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Date, Converter={StaticResource DateStringConverter}}" TextAlignment="Right"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Last Play" Width="120" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding LastPlayDate, Converter={StaticResource DateStringConverter}}" TextAlignment="Right"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Count" Width="50" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding PlayCount}" TextAlignment="Right"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Trimming" Width="100" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding TrimRange}" TextAlignment="Right"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Checked" Width="40" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Viewbox Width="20" Height="20">
                                    <Canvas Width="24" Height="24">
                                        <Path Style="{StaticResource CheckIconStyle}"/>
                                    </Canvas>
                                </Viewbox>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Rating" Width="40" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Viewbox Width="20" Height="20">
                                    <Canvas Width="24" Height="24">
                                        <Path Style="{StaticResource RatingIconStyle}"/>
                                    </Canvas>
                                </Viewbox>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Aspect" Width="40" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Aspect, Converter={StaticResource AspectStringConverter}}" TextAlignment="Center"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <!--<GridViewColumn Header="Mark" Width="50" DisplayMemberBinding="{Binding Mark}"/>-->
                    <GridViewColumn Header="Title" Width="150" DisplayMemberBinding="{Binding Title}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                    <GridViewColumn Header="Path" Width="Auto" DisplayMemberBinding="{Binding Path}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                </GridView>
            </ListView.View>
        </common:StretchListView>
        <Grid Grid.Row="2" Background="{StaticResource ToolBarBG}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="6,2,4,4">
                <TextBlock Text="{Binding StatusMessage.Value}" Foreground="White"/>
            </StackPanel>
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="4,2,6,4">
                <TextBlock Foreground="White">
                    <TextBlock.Inlines>
                        <Run Text="{Binding ItemCount.Value, Mode=OneWay}"/>
                        <Run Text=" Files"/>
                    </TextBlock.Inlines>
                </TextBlock>
            </StackPanel>
               
        </Grid>
    </Grid>
</Window>
